{"ast":null,"code":"import _objectSpread from \"/Users/apple/Desktop/React/Groove/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread\";\nimport _slicedToArray from \"/Users/apple/Desktop/React/Groove/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nvar _jsxFileName = \"/Users/apple/Desktop/React/Groove/client/src/components/User/cart.jsx\";\nimport React, { useState, useEffect } from \"react\";\nimport UserLayout from \"../../hoc/user\";\nimport { connect } from \"react-redux\";\nimport { getBasketItems, removeFromBasket, onSuccessPurchase } from \"../../store/actions/userActions\";\nimport FontAwesomeIcon from \"@fortawesome/react-fontawesome\";\nimport faFrown from \"@fortawesome/fontawesome-free-solid/faFrown\";\nimport faSmile from \"@fortawesome/fontawesome-free-solid/faSmile\";\nimport CartBlock from \"./cartBlock\";\nimport Paypal from \"../shared/paypal\";\n\nconst UserCart = props => {\n  const _useState = useState({\n    loading: true,\n    total: 0,\n    success: false,\n    amount: false\n  }),\n        _useState2 = _slicedToArray(_useState, 2),\n        state = _useState2[0],\n        setState = _useState2[1];\n\n  const user = props.user;\n  const cart = user.userData.cart;\n  useEffect(() => {\n    let cartItems = [];\n\n    if (cart && cart.length > 0) {\n      cart.forEach(item => {\n        cartItems.push(item.id);\n      });\n      props.dispatch(getBasketItems(cartItems, cart)).then(res => {\n        if (res.payload.length > 0) {\n          calculateTotal(res.payload);\n        }\n      });\n    }\n  }, []);\n\n  const removeFromCart = id => {\n    props.dispatch(removeFromBasket(id)).then(res => {\n      if (res.payload.cartData.length === 0) {\n        setState(_objectSpread({}, state, {\n          amount: false\n        }));\n      } else {\n        calculateTotal(res.payload.cartData);\n      }\n    });\n  };\n\n  const calculateTotal = data => {\n    let total = 0;\n    data.forEach(item => {\n      total += parseInt(item.price, 10) * item.quantity;\n    });\n    setState(_objectSpread({}, state, {\n      total,\n      amount: true\n    }));\n  };\n\n  const handleTransactionError = data => {\n    window.alert('Transaction error. Please try agin later.');\n  };\n\n  const handleTransactionCanceled = data => {\n    window.alert('Transaction cancelled.');\n  };\n\n  const handleTransactionSuccess = data => {\n    props.dispatch(onSuccessPurchase({\n      cartData: props.user.cartData,\n      paymentData: data\n    })).then(res => {\n      if (res.payload.success) {\n        setState(_objectSpread({}, state, {\n          amount: false,\n          success: true\n        }));\n      }\n    });\n  };\n\n  return React.createElement(UserLayout, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 88\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 89\n    },\n    __self: this\n  }, React.createElement(\"h1\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 90\n    },\n    __self: this\n  }, \"My Basket\"), React.createElement(\"div\", {\n    className: \"user_cart\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 91\n    },\n    __self: this\n  }, React.createElement(CartBlock, {\n    products: props.user,\n    type: \"cart\",\n    removeItem: id => removeFromCart(id),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 92\n    },\n    __self: this\n  }), state.amount ? React.createElement(\"div\", {\n    className: \"user_cart_sum\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 98\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 99\n    },\n    __self: this\n  }, \"Total Amount: \\xA3 \", state.total)) : state.success ? React.createElement(\"div\", {\n    className: \"cart_success\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 101\n    },\n    __self: this\n  }, React.createElement(FontAwesomeIcon, {\n    icon: faSmile,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 102\n    },\n    __self: this\n  }), React.createElement(\"div\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 103\n    },\n    __self: this\n  }, \"Thank you for your order!\", React.createElement(\"br\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 103\n    },\n    __self: this\n  }), \" You will shortly receive a confirmation email.\")) : React.createElement(\"div\", {\n    className: \"cart_no_items\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 106\n    },\n    __self: this\n  }, React.createElement(FontAwesomeIcon, {\n    icon: faFrown,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 107\n    },\n    __self: this\n  }), React.createElement(\"div\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 108\n    },\n    __self: this\n  }, \"There are no items in your basket.\"))), state.amount && React.createElement(\"div\", {\n    className: \"paypal_button_container\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 114\n    },\n    __self: this\n  }, React.createElement(Paypal, {\n    toPay: state.total,\n    transactionError: data => handleTransactionError(data),\n    transactionCanceled: data => handleTransactionCanceled(data),\n    onSuccess: data => handleTransactionSuccess(data),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 115\n    },\n    __self: this\n  }))));\n};\n\nconst mapStateToProps = state => {\n  return {\n    user: state.user\n  };\n};\n\nexport default connect(mapStateToProps)(UserCart);","map":{"version":3,"sources":["/Users/apple/Desktop/React/Groove/client/src/components/User/cart.jsx"],"names":["React","useState","useEffect","UserLayout","connect","getBasketItems","removeFromBasket","onSuccessPurchase","FontAwesomeIcon","faFrown","faSmile","CartBlock","Paypal","UserCart","props","loading","total","success","amount","state","setState","user","cart","userData","cartItems","length","forEach","item","push","id","dispatch","then","res","payload","calculateTotal","removeFromCart","cartData","data","parseInt","price","quantity","handleTransactionError","window","alert","handleTransactionCanceled","handleTransactionSuccess","paymentData","mapStateToProps"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport UserLayout from \"../../hoc/user\";\nimport { connect } from \"react-redux\";\nimport { getBasketItems, removeFromBasket, onSuccessPurchase } from \"../../store/actions/userActions\";\nimport FontAwesomeIcon from \"@fortawesome/react-fontawesome\";\nimport faFrown from \"@fortawesome/fontawesome-free-solid/faFrown\";\nimport faSmile from \"@fortawesome/fontawesome-free-solid/faSmile\";\nimport CartBlock from \"./cartBlock\";\nimport Paypal from \"../shared/paypal\";\n\nconst UserCart = props => {\n  const [state, setState] = useState({\n    loading: true,\n    total: 0,\n    success: false,\n    amount: false\n  });\n\n  const { user } = props;\n  const { cart } = user.userData;\n\n  useEffect(() => {\n    let cartItems = [];\n\n    if (cart && cart.length > 0) {\n      cart.forEach(item => {\n        cartItems.push(item.id);\n      });\n    \n    props.dispatch(getBasketItems(cartItems, cart)).then(res => {\n      if (res.payload.length > 0) {\n        calculateTotal(res.payload);\n      }\n    });\n  }\n  }, []);\n\n  const removeFromCart = id => {\n    props.dispatch(removeFromBasket(id)).then(res => {\n      if(res.payload.cartData.length === 0){\n        setState({\n          ...state,\n          amount: false\n        })\n      } else {\n        calculateTotal(res.payload.cartData)\n      }\n    });\n  };\n\n  const calculateTotal = data => {\n    let total = 0;\n\n    data.forEach(item => {\n      total += parseInt(item.price, 10) * item.quantity;\n    });\n    setState({\n      ...state,\n      total,\n      amount: true\n    });\n  };\n\n  const handleTransactionError = data => {\n    window.alert('Transaction error. Please try agin later.');\n  }\n\n  const handleTransactionCanceled = data => {\n    window.alert('Transaction cancelled.')\n  }\n\n  const handleTransactionSuccess = data => {\n    props.dispatch(onSuccessPurchase({\n      cartData: props.user.cartData,\n      paymentData: data\n    })).then((res) => {\n      if(res.payload.success){\n        setState({\n          ...state,\n          amount: false,\n          success: true\n        })\n      }\n    })\n  }\n\n  return (\n    <UserLayout>\n      <div>\n        <h1>My Basket</h1>\n        <div className=\"user_cart\">\n          <CartBlock\n            products={props.user}\n            type=\"cart\"\n            removeItem={id => removeFromCart(id)}\n          />\n          { state.amount ?\n            <div className=\"user_cart_sum\">\n              <div>Total Amount: £ {state.total}</div>\n            </div> : state.success ?\n              <div className=\"cart_success\">\n                <FontAwesomeIcon icon={faSmile} />\n                <div>Thank you for your order!<br/> You will shortly receive a confirmation email.</div>\n              </div>\n            :\n            <div className=\"cart_no_items\">\n              <FontAwesomeIcon icon={faFrown} />\n              <div>There are no items in your basket.</div>\n            </div>\n          }\n        </div>\n        {\n          state.amount && \n          <div className=\"paypal_button_container\">\n            <Paypal\n              toPay={state.total}\n              transactionError={data => handleTransactionError(data)}\n              transactionCanceled={data => handleTransactionCanceled(data)}\n              onSuccess={data => handleTransactionSuccess(data)}\n            />\n          </div>\n        }\n      </div>\n    </UserLayout>\n  );\n};\n\nconst mapStateToProps = state => {\n  return {\n    user: state.user\n  };\n};\n\nexport default connect(mapStateToProps)(UserCart);\n"]},"metadata":{},"sourceType":"module"}